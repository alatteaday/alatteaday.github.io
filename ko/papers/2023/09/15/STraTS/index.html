<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <!--site.title site.tagline-->
  <title>
    
      [Paper] Self-Supervised Transformer for Sparse and Irregularly Sampled Multivariate Clinical Time-Series (ACM 2022) &middot; Coffee Chat
    
  </title>

  
  <link rel="canonical" href="https://alatteaday.github.io/ko/papers/2023/09/15/STraTS/">
  

  <link rel="stylesheet" href="https://alatteaday.github.io/public/css/poole.css">
  <link rel="stylesheet" href="https://alatteaday.github.io/public/css/syntax.css">
  <link rel="stylesheet" href="https://alatteaday.github.io/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://alatteaday.github.io/public/favicon.ico/apple-touch-icon.png">
  <link rel="shortcut icon" href="https://alatteaday.github.io/public/favicon.ico/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://alatteaday.github.io/ko/atom.xml">

  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Curation of studies, techs, ideas and a journey as a maching learning engineer</p>
  </div>

  <nav class="sidebar-nav">

    <a class="sidebar-nav-item" href="https://alatteaday.github.io/ko/about">About</a>
    <a class="sidebar-nav-item" href="https://alatteaday.github.io/ko/">Home</a>
    <a class="sidebar-nav-item" href="https://alatteaday.github.io/ko/tags">Tags</a>

    

    
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
          <a class="sidebar-nav-item" 
          href="https://alatteaday.github.io/ko/about/">About</a>
        
        -->
        
      
    
      
    
      
        <!--
        
        -->
        
          <a class="sidebar-nav-item "
          href="https://alatteaday.github.io/ko/category/error/">Dev Tips & Fixes</a>
        
      
    
      
        <!--
        
        -->
        
          <a class="sidebar-nav-item "
          href="https://alatteaday.github.io/ko/category/papers/">Papers</a>
        
      
    
      
        <!--
        
        -->
        
          <a class="sidebar-nav-item "
          href="https://alatteaday.github.io/ko/category/study/">Study</a>
        
      
    
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
    <!--
    <a class="sidebar-nav-item" href="/ko/archive/v1.1.0.zip">Download</a>
    <a class="sidebar-nav-item" href="">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.1.0</span> 
    -->
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2024. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <!--site.title site.tagline-->
    <div class="wrap">
      <div class="masthead">
        <div class="container" >
          <h3 class="masthead-title">
            <a href="/ko/" title="Home">Coffee Chat</a>
            <small>Brewing AI Knowledge</small>
          </h3>
          <div class="lang-switcher">
    
    
        
            <a href=" /papers/2023/09/15/STraTS/">eng</a>
        
    

    
    
        kor
    

</div>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">[Paper] Self-Supervised Transformer for Sparse and Irregularly Sampled Multivariate Clinical Time-Series (ACM 2022)</h1>
  <p class="post-date">15 Sep 2023&nbsp;&nbsp;&nbsp;&nbsp;
    <!--<span class="post-date">15 Sep 2023</span>-->
    
      
        
          <span class="tag" data-tag="bio">
            <a href="https://alatteaday.github.io/ko/tags/?tag=bio">
              #bio
            </a>
          </span>
        
      
        
          <span class="tag" data-tag="ehr">
            <a href="https://alatteaday.github.io/ko/tags/?tag=ehr">
              #ehr
            </a>
          </span>
        
      
        
          <span class="tag" data-tag="transformer">
            <a href="https://alatteaday.github.io/ko/tags/?tag=transformer">
              #transformer
            </a>
          </span>
        
      
    
  </p>
  <p>Tipirneni, Sindhu, and Chandan K. Reddy. “Self-supervised transformer for sparse and irregularly sampled multivariate clinical time-series.” <em>ACM Transactions on Knowledge Discovery from Data (TKDD)</em> 16.6 (2022): 1-17.</p>

<p><a href="https://dl.acm.org/doi/full/10.1145/3516367">Paper Link</a></p>

<h2 id="points">Points</h2>

<p><strong>Self-supervised Transformer for Time-Series (STraTS) model</strong></p>

<ul>
  <li>
    <p>Using observation triplets as time-series components: avoids the problems faced by aggregation and imputation methods for sparse and sporadic multivariate time-series</p>
  </li>
  <li>
    <p>Continuous Value Embedding: encodes continuous time and variable values without the need for discretization</p>
  </li>
  <li>
    <p>Transformer-based model: learns contextual triplet embeddings</p>
  </li>
  <li>
    <p>Time series forecasting as a proxy task: leverages unlabeled data to learn better generalized representations</p>
  </li>
</ul>

<h2 id="background">Background</h2>

<p>Problems</p>

<ul>
  <li>Multivariate time-series data are frequently observed in critical care settings and are typically characterized by sparsity (missing information) and irregular time intervals.</li>
  <li>Existing approaches, such as aggregation or imputation of values, suppress the fine-grained information and add undesirable noise/overhead into the model.</li>
  <li>The problem of limited availability of labeled data is easily observed in healthcare applications.</li>
</ul>

<p>The clinical domain portrays a unique set of challenges:</p>

<ul>
  <li>Missingness and Sparsity: Not all the variables are observed for every patient. Also, the time-series matrices are very sparse.</li>
  <li>Irregular time intervals and Sporadicity: Not all clinical variables are measured at regular time intervals. The measurements may occur sporadically in time depending.</li>
  <li>Limited labeled data: expensive and even more limited for specific tasks.</li>
</ul>

<p>Existing methods</p>

<ul>
  <li>Aggregation: could suppress important fine-grained information</li>
  <li>Imputation/Interpolation: not reasonable as not considering the domain knowledge about each variable</li>
</ul>

<h2 id="method">Method</h2>

<p><strong>Self-supervised Transformer for Time-Series (STraTS)</strong></p>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/1_fig3.png?raw=true" alt="" /></p>

<h3 id="embeddings">Embeddings</h3>

<p><strong>Triplet Emgeddings</strong> = Feature embedding + Value embedding + Time embedding
\(T=\{(t_i, j_i, u_i)\}^n_{i=1}\\
e_i=e_i^f+e_i^v+e_i^t\)
<strong>Continuous Value Embedding (CVE)</strong></p>

<p>For continuous values of feature values and times</p>

<p>A one-to-many Feed-Forward Network
\(FFN(x) = U tanh(Wx+b)\)</p>

<ul>
  <li>
    <p>Feature embeddings $e_i^f$: obtained from a simpole lookup table</p>
  </li>
  <li>
    <p>Value embeddings $e_i^v$ and Time embeddings$e_i^t$: through CVE</p>
  </li>
</ul>

<p><strong>Demographics Embedding</strong></p>

<p>the prediction models performed better when demographics were processed separately.
\(e^𝑑 = 𝑡𝑎𝑛ℎ(W^𝑑_2𝑡𝑎𝑛ℎ(W^𝑑_1d + b^𝑑_1) + b^𝑑_2) ∈ R^d\)
where the hidden layer has a dimension of 2d</p>

<h3 id="self-supervision">Self-Supervision</h3>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/2_fig2.png?raw=true" alt="" /></p>

<p>Pre-training Tasks: Both masking and forecasting as pretext tasks for providing self-supervision</p>

<p>The forecasitng improved the results on target tasks</p>

<p>The loss is:
\(L_{ss}=\frac{1}{|N'|}\sum_{k=1}^{N'}\sum_{j=1}^{|F|}m_j^k\Big(\tilde{z}_j^k-z_j^k\Big)^2\)</p>

<h3 id="interpretability">Interpretability</h3>

<p>I-STraTS: an interpretable version of STraTS</p>

<ul>
  <li>The output can be expressed using a linear combination of components that are derived from individual features</li>
</ul>

<p>Differences with STraTS</p>

<ul>
  <li>Combine the initial triplet embeddings in Fusion Self-attention module</li>
  <li>Directly use the raw demographics vector as the demographics embedding</li>
</ul>

\[\tilde{y}=sigmoid\Big(\sum_{j=1}^{D}{\bold{w}_0[j]d[j]+\sum_{i=1}^{n}\sum_{j=1}^{d}\alpha_i\bold{w}_o[j+D]\bold{e}_i[j]+b_o}\Big)\]

<h2 id="experiments">Experiments</h2>

<p>Target Task: Prediction of in-hospital mortality</p>

<p>Datasets: 2 EHR datasets; MIMIC-III and PhysioNet Challenge 2012</p>

<ul>
  <li>MIMIC-III: 46,000 patients</li>
  <li>PhysioNet-2012: 11,988 patients</li>
</ul>

<p>Baselines: Gated Recurrent Unit (GRU), Temporal Convolutional Network (TCN), Simply Attend and DIagnose (SaND), GRU with trainable Decays (GRU-D), Interpolation-prediction Network (InterpNet), Set Functions for Time Series (SeFT)</p>

<ul>
  <li>Used 2 dense layers for demographics encoding</li>
  <li>Concatenated it to the time-series representation before the last dense layer</li>
</ul>

<p>Metrics</p>

<ul>
  <li>ROC-AUC: Area under ROC curve</li>
  <li>PR-AUC: Area under precision-recall curve</li>
  <li>min(Re, Pr): the max of ‘min of recall and precision’ across all thresholds</li>
</ul>

<h3 id="prediction-performance">Prediction Performance</h3>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/3_table4.png?raw=true" style="zoom:80%;" /></p>

<ul>
  <li>Trained each model using 10 different random samplings of 50% labeled data from the train and validation sets</li>
  <li>STraTS uses the entire labeled data and additional unlabeled data if avaliable</li>
  <li>STraTS achieves the best performance</li>
  <li>GRU showed better performance than interpolation-based models (GRU-D, InterpNet) on the MIMIC-III dataset, which was not expected</li>
</ul>

<p><strong>Generalizability test of models</strong></p>

<p>Lower propotions of labeled data can be observed in real-world when there are several right-censord samples.</p>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/4_fig5.png?raw=true" alt="" /></p>

<ul>
  <li>STraTS has an advantage compared to others in scarce labeled data settings, which can be attributed to self-supervision</li>
</ul>

<h3 id="ablation-study">Ablation Study</h3>

<p>Compared STraTS and I-STraTS with and without self-supervision: ‘ss+’ and ‘ss-‘ indicate each case</p>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/5_table5.png?raw=true" style="zoom:80%;" /></p>

<ul>
  <li>I-STraTS showed slightly worse performance as constrained its representations</li>
  <li>Adding self-supervision improves performance of both models</li>
  <li>I-STraTS(ss+) outperforms STraTS(ss-): self-supervision can compensate the performance which could get lower by introducing interpretability</li>
</ul>

<h3 id="interpretability-1">Interpretability</h3>

<p>How I-STraTS explains its predictions</p>

<p>A case study: a 85 yrs old female patient from MIMIC-III</p>

<ul>
  <li>expired on the 6th day after ICU admission</li>
  <li>had 380 measurements corresponding to 58 time-series variables</li>
</ul>

<p>The model predicts the probability of her in-hospital mortality as 0.94 using only the data collected the first day</p>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/6_table6.png?raw=true" alt="" /></p>

<ul>
  <li>Average contribution score: the average score along with the range, for multiple observations, or value, for only one observation</li>
  <li>The top 5 variables are the most important factors in predicting she ‘s at high risk of mortality that the model observed</li>
</ul>

<p>&amp;rarr Can be helpful to identify high-risk patients and also understand the contributing factors and make better diagnoses, especially at the early stages of treatment</p>

</div>


<div class="related">
  <h2 class="related-title">Related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/ko/paper/2024/06/14/mriqcsurvey/">
            MRI Quality Assessment 및 Control 관련 네 개 논문 요약&nbsp;
            <small>14 Jun 2024</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/ko/study/2024/05/28/mriqc_report/">
            [MRIQC 4] MRIQC Report와 Image Quality Metrics (IQMs)&nbsp;
            <small>28 May 2024</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/ko/study/dev%20tips%20&%20fixes/2024/05/21/html_flask/">
            [MRIQC 3-1] Flask를 사용해 HTML 파일 열어보기&nbsp;
            <small>21 May 2024</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>


        
          <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$$', '$$$'], ['\\[', '\\]'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
</script>
<script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
        
      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='/public/js/script.js'></script>
  </body>
</html>
