<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <!--site.title site.tagline-->
  <title>
    
      Coffee Chat &middot; Brewing AI Knowledge
    
  </title>

  
  <link rel="canonical" href="https://alatteaday.github.io/ko/page4/">
  

  <link rel="stylesheet" href="https://alatteaday.github.io/public/css/poole.css">
  <link rel="stylesheet" href="https://alatteaday.github.io/public/css/syntax.css">
  <link rel="stylesheet" href="https://alatteaday.github.io/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://alatteaday.github.io/public/favicon.ico/apple-touch-icon.png">
  <link rel="shortcut icon" href="https://alatteaday.github.io/public/favicon.ico/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://alatteaday.github.io/ko/atom.xml">

  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Curation of studies, techs, ideas and a journey as a maching learning engineer</p>
  </div>

  <nav class="sidebar-nav">

    <a class="sidebar-nav-item" href="https://alatteaday.github.io/ko/about">About</a>
    <a class="sidebar-nav-item active" href="https://alatteaday.github.io/ko/">Home</a>
    <a class="sidebar-nav-item" href="https://alatteaday.github.io/ko/tags">Tags</a>

    

    
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
          <a class="sidebar-nav-item" 
          href="https://alatteaday.github.io/ko/about/">About</a>
        
        -->
        
      
    
      
    
      
        <!--
        
        -->
        
          <a class="sidebar-nav-item "
          href="https://alatteaday.github.io/ko/category/error/">Dev Tips & Fixes</a>
        
      
    
      
        <!--
        
        -->
        
          <a class="sidebar-nav-item "
          href="https://alatteaday.github.io/ko/category/papers/">Papers</a>
        
      
    
      
        <!--
        
        -->
        
          <a class="sidebar-nav-item "
          href="https://alatteaday.github.io/ko/category/study/">Study</a>
        
      
    
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
      
        <!--
        
        -->
        
      
    
    <!--
    <a class="sidebar-nav-item" href="/ko/archive/v1.1.0.zip">Download</a>
    <a class="sidebar-nav-item" href="">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.1.0</span> 
    -->
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2024. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <!--site.title site.tagline-->
    <div class="wrap">
      <div class="masthead">
        <div class="container" >
          <h3 class="masthead-title">
            <a href="/ko/" title="Home">Coffee Chat</a>
            <small>Brewing AI Knowledge</small>
          </h3>
          <div class="lang-switcher">
    
    
        
            <a href=" /page4/">eng</a>
        
    

    
    
        kor
    

</div>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://alatteaday.github.io/ko/study/2023/12/26/mri2/">
        [LearnMRI] MR Modality ì¢…ë¥˜ì™€ ê´€ì°° ê°€ëŠ¥í•œ ë‡Œ ì–‘ìƒ
      </a>
    </h1>
    <!--<span class="post-date">26 Dec 2023</span>-->
    <p class="post-date">26 Dec 2023&nbsp;&nbsp;&nbsp;&nbsp;
      
        
          
            <span class="tag" data-tag="bio">
              <a href="https://alatteaday.github.io/ko/tags/?tag=bio">
                #bio
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="brainImaging">
              <a href="https://alatteaday.github.io/ko/tags/?tag=brainImaging">
                #brainImaging
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="mri">
              <a href="https://alatteaday.github.io/ko/tags/?tag=mri">
                #mri
              </a>
            </span>
            
        
      
    </p>
    <!--
    
    -->
    <p><a href="https://alatteaday.github.io/ko/study/2023/12/26/mri/">Spin echo ê¸°ë²•</a>ì— ë”°ë¼ T1 ê°•ì¡° ì˜ìƒ(T1 weighted image; T1WI)ê³¼ T2 ê°•ì¡° ì˜ìƒ(T2 weighted image; T2WI)ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. ì´ë“¤ì— ì˜ìƒ ì¡°ì‘ì„ ë”í•˜ì—¬ ë‹¤ì–‘í•œ MR modality ì˜ìƒì„ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ì˜ìƒë§ˆë‹¤ ë³‘ë³€ ì¡°ì§ì˜ ì‹ í˜¸ ê°•ë„(signal intensity)ê°€ ë‹¬ë¦¬ ë‚˜íƒ€ë‚˜ë¯€ë¡œ, ê°•ì¡°ë˜ëŠ” ë³‘ë³€ì˜ ì¢…ë¥˜ê°€ ë‹¤ë¥´ë‹¤.</p>

<p align="center">
  <img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-12-25-mri/t1_t2_flair.png?raw=true" style="zoom: 50%;" />
</p>

<p><br /></p>

<h3 id="t1-ê°•ì¡°-ì˜ìƒ-t1-weighted-image-t1wi">T1 ê°•ì¡° ì˜ìƒ (T1-weighted image; T1WI)</h3>

<ul>
  <li>Spin echo: TRê³¼ TEë¥¼ ëª¨ë‘ ì§§ê²Œ ì¤€ë‹¤
    <ul>
      <li>TRì´ ì§§ì•„ì§€ë©´ ì¡°ì§ë§ˆë‹¤ ë‹¤ë¥¸ $Mz$ì˜ 90ë„ pulse íšŒë³µ ì‹œê°„(T1 relaxation time)ì´ ê°•ì¡°ëœë‹¤. ì–´ëŠ ì¡°ì§ì€ ëª¨ë‘ íšŒë³µë˜ê³ , ì–´ëŠ ì¡°ì§ì€ ëœ ëœ ìƒíƒœë¡œ ë‘ ë²ˆì§¸ pulseì˜ ì˜í–¥ì„ ë°›ìœ¼ë©´, ì „ìëŠ” ì˜í–¥ì„ ë§ì´, í›„ìëŠ” ëœ ë°›ê²Œ ëœë‹¤. ì´ ì°¨ì´ê°€ ì˜ìƒì— ë°˜ì˜ ëœë‹¤.</li>
      <li>TEë¥¼ ì§§ê²Œ ì£¼ì–´ì•¼ T2 relxation time ê°’ì— ì˜í–¥ì„ ëœ ì¤Œìœ¼ë¡œì¨ ì´ë¥¼ í†µì œí•  ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
  <li>Signal intensity:
    <ul>
      <li>Signal intensityê°€ T2-weighted imageë³´ë‹¤ ë†’ì•„ í•´ë¶€í•™ì (anatomical) êµ¬ì¡°ë¬¼ì´ ë” ëª…í™•íˆ êµ¬ë³„ëœë‹¤.</li>
      <li>í”¼í•˜ì§€ë°©(fat) ë° í˜ˆì•¡(blood)ì€ ë°ê²Œ(hyperintense), ê·¼ìœ¡ì€ ì¤‘ê°„ ì •ë„ì˜ ë°ê¸°ë¡œ, ìˆ˜ë¶„(water)ì€ ì–´ë‘¡ê²Œ(hypointense) ë³´ì¸ë‹¤.</li>
      <li>ê³¨ìˆ˜(marrow)ëŠ” ì§€ë°©ì´ í’ë¶€í•˜ë¯€ë¡œ, ê³¨í”¼ì§ˆ(cortex)ì€ ìˆ˜ë¶„ì´ ì ìœ¼ë¯€ë¡œ hyperintenseí•˜ê²Œ ë‚˜íƒ€ë‚œë‹¤.</li>
      <li>ë³‘ë³€: ì§€ë°©ì¢…, ì•„ê¸‰ì„± ì¶œí˜ˆ, ê³ ë‹¨ë°±ì§ˆ í•¨ìœ  ë³‘ì†Œ(ì ì•¡ë‚­ì¢…(mococele) ë“±)</li>
    </ul>
  </li>
  <li>Observe: ë‡Œ í”¼ì§ˆ í˜•íƒœ(anatomical detail), í˜ˆê´€ ë³€í™”(vascular changes), í˜ˆë‡Œì¥ë²½(blood-brain barrier) ì†ìƒ ì—¬ë¶€</li>
  <li>Feature: cortical thickness, choroid plexus (ChP)</li>
</ul>

<p><br /></p>

<h3 id="t2-ê°•ì¡°-ì˜ìƒ-t2-weighted-image-t2wi">T2 ê°•ì¡° ì˜ìƒ (T2-weighted image; T2WI)</h3>

<ul>
  <li>Spin echo: TRê³¼ TEë¥¼ ëª¨ë‘ ê¸¸ê²Œ ì¤€ë‹¤
    <ul>
      <li>TRì„ ê¸¸ê²Œ ì£¼ì–´ T1 relaxation timeì— ì˜í–¥ì„ ëœ ì¤€ë‹¤.</li>
      <li>TEê°€ ê¸¸ìˆ˜ë¡ ì¡°ì§ë§ˆë‹¤ $Mxy$ê°€ ê°ì†Œë˜ëŠ” ìˆ˜ì¤€ì˜ ì°¨ì´ê°€ ê°•ì¡°ë˜ì–´ ì˜ìƒì— ë‹¬ë¦¬ í‘œí˜„ëœë‹¤.</li>
    </ul>
  </li>
  <li>Signal intensity:
    <ul>
      <li>ìˆ˜ë¶„(water)ì´ hyperintenseí•œë°, ë³‘ì  ì¡°ì§ì€ ìˆ˜ë¶„ì„ ë§ì´ í•¨ìœ í•˜ë¯€ë¡œ ë³‘ì†Œ(lesion)ê°€ ì‰½ê²Œ ê´€ì°°ëœë‹¤.
        <ul>
          <li>ëŒ€ë¶€ë¶„ì˜ ë³‘ë³€ì€ T1ì—ì„œëŠ” ì €ì‹ í˜¸, T2ì—ì„œëŠ” ê³ ì‹ í˜¸ë¡œ ë‚˜íƒ€ë‚œë‹¤.</li>
          <li>ìˆ˜ë¶„ í•¨ìœ ëŸ‰ì´ ë§ì€ ì¡°ì§ì¼ ìˆ˜ë¡ hyperintenseí•˜ë‹¤: ë‚­ì¢… &gt; ë¶€ì¢… &gt; ì •ìƒ ì¡°ì§ ìˆœìœ¼ë¡œ ë°ê²Œ ë³´ì¸ë‹¤.</li>
        </ul>
      </li>
      <li>ë‡Œì²™ìˆ˜ì•¡(cerebrospinal fluid; CSF)ë„ hyperintenseí•˜ì—¬ ë³‘ë³€ê³¼ êµ¬ë¶„ì´ ì˜ ë˜ì§€ ì•ŠëŠ”ë‹¤.</li>
      <li>Muscle, fat, bloodëŠ” hypointenseí•˜ë‹¤.</li>
    </ul>
  </li>
  <li>Observation: ë³‘ì†Œ(lesion), hypo ë³‘ë³€ (ê¸‰ì„±í˜ˆì¢…, ì§„ê· êµ¬ ë“±), ë™ë§¥ (ì •ë§¥ì€ í˜ˆë¥˜ ì†ë„ê°€ ëŠë ¤ í™˜ìë§ˆë‹¤ ì‹ í˜¸ ê°•ë„ê°€ ë‹¤ë¥´ë‹¤)</li>
  <li>Feature: <a href="https://alatteaday.github.io/ko/study/2023/12/26/mri3/">Perivascular space (PVS)</a></li>
</ul>

<p><br /></p>

<h2 id="flair-fluid-attenuation-inversion-recovery">FLAIR (Fluid Attenuation Inversion Recovery)</h2>

<ul>
  <li>T2ì—ì„œ CSFë¥¼ ê¹Œë§£ê²Œ ì²˜ë¦¬í•œ ì´ë¯¸ì§€ì´ë‹¤.</li>
  <li>Signal intensity: Non-free-flowing waterëŠ” hyperintense, fatì€ hypointenseë¡œ ë‚˜íƒ€ë‚œë‹¤.</li>
  <li>Observation: ë‡Œì‹¤(ventricle) ë¶€ê·¼ì˜ ë³‘ì†Œ, ë¶€ì¢…(edema, ë¶€ì¢…ì€ ì •ì²´ëœ ìˆ˜ë¶„ì´ë¼ ë°ê²Œ ë‚˜íƒ€ë‚œë‹¤), íšŒë°±ì§ˆì˜ ì°¨ì´(grey-white differentiation)</li>
  <li>Feature: lesion, <a href="https://alatteaday.github.io/ko/study/2023/12/26/mri3/">white matter hyperintensity (WMH)</a></li>
</ul>

<p><br /></p>

<h2 id="gre-gradient-echo-t2">GRE (Gradient Echo; T2*)</h2>

<p align="center">
  <img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-12-25-mri/gre.png?raw=true" style="zoom: 25%;" />
</p>

<ul>
  <li>Signal intensity: ìƒìì„±ì²´ ë¬¼ì§ˆ(paramegnetic substances, blood, calcium, metal ë“±)ì´ hyperintenseë¡œ ë‚˜íƒ€ë‚˜, ì² ì˜ ì¹¨ì°©ê³¼ ê´€ë ¨ëœ ì‚¬í•­ì„ ê´€ì°°í•˜ê¸° ìš©ì´í•˜ë‹¤.</li>
  <li>Observation: ë‡Œì¶œí˜ˆ ì´ˆê¸°/ë§ê¸°, ë¯¸ë§Œì„± ì¶•ì‚­ì†ìƒ(diffuse axonal injury)ì—ì„œ ë³´ì´ëŠ” microbleed ê²€ì¶œì— íƒì›”
    <ul>
      <li>*diffuse axonal injury: ë‡Œì§„íƒ• ë“± ë‡Œì†ìƒì˜ êµ¬ì„±ìš”ì†Œ ì¤‘ í•˜ë‚˜, ì¶•ì‚­ ì†ìƒìœ¼ë¡œ ì¸í•´ ì™¸ìƒ í›„ í˜¼ìˆ˜ìƒíƒœë¥¼ ë³´ì´ëŠ” íŠ¹ì§•ì´ ìˆë‹¤.</li>
    </ul>
  </li>
  <li>Feature: bleeding</li>
</ul>


    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$$', '$$$'], ['\\[', '\\]'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
</script>
<script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://alatteaday.github.io/ko/study/2023/12/26/mri/">
        [LearnMRI] MRI ì´¬ì˜ ì›ë¦¬ì™€ íŠ¹ì§•
      </a>
    </h1>
    <!--<span class="post-date">26 Dec 2023</span>-->
    <p class="post-date">26 Dec 2023&nbsp;&nbsp;&nbsp;&nbsp;
      
        
          
            <span class="tag" data-tag="bio">
              <a href="https://alatteaday.github.io/ko/tags/?tag=bio">
                #bio
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="brainImaging">
              <a href="https://alatteaday.github.io/ko/tags/?tag=brainImaging">
                #brainImaging
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="mri">
              <a href="https://alatteaday.github.io/ko/tags/?tag=mri">
                #mri
              </a>
            </span>
            
        
      
    </p>
    <!--
    
    -->
    <p>MRIì™€ MRI modalities, MRIì—ì„œ ê´€ì°° ê°€ëŠ¥í•œ Alzheimerâ€™s disease ê´€ë ¨ featureë¥¼ ì •ë¦¬í•´ë´…ë‹ˆë‹¤.
<br /></p>

<h2 id="magnetic-resonance-imaging-mri">Magnetic Resonance Imaging (MRI)</h2>

<p>ìì„ìœ¼ë¡œ êµ¬ì„±ëœ ì¥ì¹˜ì—ì„œ ì¸ì²´ì— ê³ ì£¼íŒŒë¥¼ ì˜ì•„ ì‹ ì²´ë¶€ìœ„ì— ìˆëŠ” ìˆ˜ì†Œì›ìí•µì„ ê³µëª…ì‹œì¼œ ê° ì¡°ì§ì—ì„œ ë‚˜ì˜¤ëŠ” ì‹ í˜¸ì˜ ì°¨ì´ë¥¼ ë””ì§€í„¸ ì •ë³´ë¡œ ë³€í™˜í•œ ì´ë¯¸ì§€</p>

<p><br /></p>

<h2 id="mri-ì´¬ì˜-ì›ë¦¬">MRI ì´¬ì˜ ì›ë¦¬</h2>

<p>ì¸ì²´ ì¡°ì§ì€ ë¬¼ì„ ë§ì´ í¬í•¨í•˜ê³  ìˆë‹¤. ë¬¼ì˜ ìˆ˜ì†Œì›ìí•µ(hydrogen nucleus)ì€ ìì„±ì„ ê°–ëŠ”ë‹¤. ì´ ìˆ˜ì†Œì›ìí•µì— ê³ ì£¼íŒŒë¥¼ ë°œì‚¬í•˜ë©´ ì´ë¥¼ ê³µëª…ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ê³ ì£¼íŒŒ(radiofrequency; RF)ë¥¼ ìˆœê°„ì ìœ¼ë¡œ ë°œì‚¬í•˜ê³  ëŠìœ¼ë©´(RF pulse), ì›ìí•µì´ ê³ ì£¼íŒŒ ì‹ í˜¸ë¥¼ í¡ìˆ˜í–ˆë‹¤ê°€ ë°©ì¶œí•œë‹¤(release). ì—¬ê¸°ì„œ MR ê¸°ê¸°ë¡œ ë˜ëŒì•„ì˜¤ëŠ” ì‹ í˜¸ì˜ í¬ê¸° ì°¨ì´ë¥¼ ë¶„ì„í•˜ê³  ê·¹ëŒ€í™”í•˜ì—¬ 2ì°¨ì› ì˜ìƒìœ¼ë¡œ í‘œí˜„í•œ ê²ƒì´ MRIì´ë‹¤.</p>

<p>ë°©ì¶œë˜ëŠ” ì‹ í˜¸ì˜ í¬ê¸°ì™€ íŒŒí˜•ì€ ë¬¼ë¶„ìì˜ ë†ë„, í˜ˆë¥˜, ì£¼ë³€ í™”í•™êµ¬ì¡°ë¬¼ê³¼ì˜ ê²°í•© ìƒíƒœ ë“±ì— ë”°ë¼ ë‹¤ë¥´ë‹¤. ì¡°ì§ ë‚´ ë¬¼ì´ë‚˜ í˜ˆì•¡ êµ¬ì„±ì— ë”°ë¼ T1 ì´ì™„ ì‹œê°„(relaxation time)ê³¼ T2 ì´ì™„ ì‹œê°„ì´ ë‹¬ë¼ì§„ë‹¤. ì§ˆë³‘ì— ë”°ë¼ ì´ë“¤ êµ¬ì„±ì´ ë‹¬ë¼ì§€ë¯€ë¡œ, ì§ˆë³‘ì— ë”°ë¼ ì–»ì„ ìˆ˜ ìˆëŠ” ì‹ í˜¸ê°€ ë‹¤ë¥´ë‹¤ëŠ” ì˜ë¯¸ê°€ ëœë‹¤. ì´ ì‹ í˜¸ ë³€í™”ë¥¼ ë‹¬ë¦¬ í¬ì°©í•˜ì—¬ <a href="https://alatteaday.github.io/ko/study/2023/12/26/mri2/">T1 ê°•ì¡° ì˜ìƒ(weighted image; WI), T2WI, FLAIR ë“± ë‹¤ì–‘í•œ MRI</a>ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</p>

<p align="center">
  <img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-12-25-mri/mr_axis.png?raw=true" style="zoom: 40%;" align="center" />
</p>

<p>T1 relaxation timeê³¼ T2 relaxation timeì€ ì–‘ì„±ì(proton)ì— RF pulseë¥¼ 90ë„ë¡œ ê°€í•œ í›„ì— ê°ê° ë‹¤ë¥¸ ê¸°ì¤€ì— ì˜í•´ ì¸¡ì •ëœë‹¤. protonì˜ ìê¸°í™”ë¥¼ ì¢…ì¶•($Mz$)ì—ì„œ íš¡ì¶•ìœ¼ë¡œ ëˆ•íˆë©´ $Mxy$ vectorê°€ í˜•ì„±ëœë‹¤. $Mz$ vectorê°€ 0%, $Mxy$ vectorê°€ 100%ê°€ ë˜ëŠ” ìˆœê°„ë¶€í„° T1, T2 relaxation timeì„ ì¸¡ì •í•œë‹¤. ì¡°ì§ë§ˆë‹¤ ë‘ relaxation time ëª¨ë‘ ìƒì´í•˜ê²Œ ë‚˜íƒ€ë‚œë‹¤.</p>

<p>T1 relaxation timeì€ $Mz$ê°€ 63%ê¹Œì§€ íšŒë³µí•˜ëŠ” ë°ì— ê±¸ë¦¬ëŠ” ì‹œê°„ì´ë‹¤. ì§€ë°©(fat) - ë‡Œì„¸í¬ ì¡°ì§(brain tissue) - ë‡Œì²™ìˆ˜ì•¡(cerebrospinal fluid; CSF) ìˆœìœ¼ë¡œ íšŒë³µì´ ë¹ ë¥´ë‹¤(T1 relaxation timeì´ ë¹ ë¥´ë‹¤).</p>

<p>T2 relaxation timeì€ $Mxy$ê°€ 37%ê¹Œì§€ ê°ì†Œí•˜ëŠ” ë°ì— ê±¸ë¦¬ëŠ” ì‹œê°„ìœ¼ë¡œ, ìì¥ì˜ ì„¸ê¸°ì— ë³„ë¡œ ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤. Fat - brain tissue - CSF ìˆœìœ¼ë¡œ ì‹ í˜¸ê°€ ë¹¨ë¦¬ ê°ì†Œí•œë‹¤.</p>

<p>T1 relaxation timeì´ ì§§ì€ ì¡°ì§ì€ T2 curveë„ ê¸‰ê²©íˆ ê°ì†Œí•œë‹¤. ë¬¼ê³¼ ì§€ë°©ì€ T1ê³¼ T2ì—ì„œ ë°˜ëŒ€ì˜ intensityë¥¼ ê°–ëŠ”ë‹¤ (opposite signal intensity).</p>

<p>Spin echoëŠ” RF pulseë¥¼ 90ë„ì™€ 180ë„ë¡œ ì£¼ì–´ repetition time (TR)ê³¼ echo time (TE)ì„ ì¡°ì‘í•˜ë©° ì˜ìƒì„ ì°ëŠ” ê¸°ë²•ì´ë‹¤. TRì€  90ë„ pulseì—ì„œ ë‹¤ìŒ 90ë„ pulseê¹Œì§€ì˜ ì‹œê°„, TEì€ 90ë„ pulseì—ì„œ ì‹ í˜¸ë¥¼ ì–»ì„ ë•Œê¹Œì§€ì˜ ì‹œê°„ì„ ë§í•œë‹¤. ì˜ìƒ ì´¬ì˜ ì‹œ pulseë¥¼ ì—¬ëŸ¬ ë²ˆ ë°˜ë³µí•˜ë¯€ë¡œ, TRê³¼ TEë¥¼ ì¡°ì‘í•˜ì—¬ <a href="https://alatteaday.github.io/ko/study/2023/12/26/mri2/">ë‹¤ì–‘í•œ ì˜ìƒ</a>ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<h2 id="mriì˜-ì¥ë‹¨ì ">MRIì˜ ì¥ë‹¨ì </h2>

<p>ì¥ì </p>
<ul>
  <li>CTì— ë¹„í•´ ì—°ë¶€ ì¡°ì§ì˜ contrastê°€ ë” ì˜ ë“œëŸ¬ë‚œë‹¤.</li>
  <li>í•´ë¶€í•™ì , ìƒë¦¬í•™ì , ê¸°ëŠ¥ì  ì •ë³´ ë“±ì„ ê´€ì°°í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p>ë‹¨ì </p>
<ul>
  <li>ì² ìì„± ì¸ê³µí—ˆìƒ(ferromagnetic artifacts): ìì¥ì— ì˜í–¥ì„ ì£¼ëŠ” ê¸ˆì†ë¬¼ì§ˆ ë“±ì´ ì²´ë‚´ ì†ŒëŸ‰ì´ë¼ë„ ì¡´ì¬í•˜ë©´ ìì¥ì˜ ê· ì§ˆì„±ì´ ê¹¨ì ¸ ì˜ìƒì´ ì™œê³¡ëœë‹¤.</li>
  <li>ê¸ˆë‹ˆë‚˜ ê¸°íƒ€ ì‚½ì… ë¬¼ì§ˆì´ ìˆìœ¼ë©´ ì˜ìƒì˜ ì§ˆì´ ë–¨ì–´ì§„ë‹¤.</li>
</ul>

<p>ê¸ˆê¸°: ìì„±ì— ì˜í–¥ì„ ë°›ì„ ìˆ˜ ìˆëŠ” ì‹ ì²´ ë‚´ ì‚½ì…ë¬¼ ë“±ì„ ê°€ì§„ í™˜ìì—ê²ŒëŠ” ì‚¬ìš©í•˜ì§€ ë§ì•„ì•¼ í•œë‹¤.</p>


    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$$', '$$$'], ['\\[', '\\]'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
</script>
<script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://alatteaday.github.io/ko/papers/2023/11/05/rag/">
        [Paper] Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks (NIPS 2020)
      </a>
    </h1>
    <!--<span class="post-date">05 Nov 2023</span>-->
    <p class="post-date">05 Nov 2023&nbsp;&nbsp;&nbsp;&nbsp;
      
        
          
            <span class="tag" data-tag="llm">
              <a href="https://alatteaday.github.io/ko/tags/?tag=llm">
                #llm
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="transformer">
              <a href="https://alatteaday.github.io/ko/tags/?tag=transformer">
                #transformer
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="nlp">
              <a href="https://alatteaday.github.io/ko/tags/?tag=nlp">
                #nlp
              </a>
            </span>
            
        
      
    </p>
    <!--
    
    -->
    <p>Lewis, Patrick, et al. â€œRetrieval-augmented generation for knowledge-intensive nlp tasks.â€ <em>Advances in Neural Information Processing Systems</em> 33 (2020): 9459-9474.</p>

<p><a href="https://proceedings.neurips.cc/paper/2020/hash/6b493230205f780e1bc26945df7481e5-Abstract.html">Paper Link</a></p>

<h1 id="points">Points</h1>

<ul>
  <li><strong>Retrieval Augmented Generation (RAG)</strong> ëª¨ë¸ì€ retrieverì™€ generatorë¥¼ ê²°í•©í•œ êµ¬ì¡°ë¡œ knowledge-intense task ìˆ˜í–‰ ëŠ¥ë ¥ì´ í–¥ìƒë˜ì—ˆë‹¤.</li>
  <li>RAG Variants: RAG-SequenceëŠ” ë‹¨ì¼ ë¬¸ì„œë¥¼ ì‚¬ìš©í•´ outputì„ ìƒì„±í•˜ê³ , RAG-Token ê° í† í°ì„ ìƒì„±í•˜ëŠ” ë° ì—¬ëŸ¬ ë¬¸ì„œë¥¼ í†µí•©í•œë‹¤.</li>
  <li>RAG ëª¨ë¸ì€ open-domain QA, abstractive QA, Jeopardy question generation, and fact verificationì—ì„œ baseline ëª¨ë¸ì„ ëŠ¥ê°€í•˜ëŠ” ê²°ê³¼ë¥¼ ë³´ì˜€ë‹¤.</li>
  <li>RAG ëª¨ë¸ì€ non-parametric memoryë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ê°„ë‹¨í•œ ë°©ë²•ìœ¼ë¡œ ìµœì‹  ìë£Œë¥¼ ì‰½ê²Œ ë°˜ì˜í•  ìˆ˜ ìˆëŠ” ì‹¤ìš©ì ì¸ ì´ì ì„ ê°–ëŠ”ë‹¤.</li>
</ul>

<p><br /></p>

<h1 id="background">Background</h1>

<ul>
  <li>Large pre-trained Language models (LLMs)ì€ ìì²´ parameterì— ì‚¬ì‹¤ ê´€ë ¨ ì§€ì‹ì„ ì €ì¥í•˜ê³ , ì´ê²ƒì„ ì§€ì‹ baseë¡œ ì‚¬ìš©í•œë‹¤.</li>
  <li>ì´ëŸ¬í•œ LLMì€ ìì²´ì ìœ¼ë¡œ ì´ëŸ¬í•œ ì§€ì‹ì„ ë‹´ê³  ìˆëŠ” ë©”ëª¨ë¦¬ë¥¼ í™•ì¥í•  ìˆ˜ ì—†ê³ , ìƒì„±ë˜ëŠ” outputì— ì‚¬ì‹¤ì ì¸ í†µì°°ì„ ë°˜ì˜í•˜ê±°ë‚˜ ë³´ì¥í•˜ê¸° ì–´ë ¤ìš°ë©°, ë‚˜ì•„ê°€ hallucination ìƒì„± ê°€ëŠ¥ì„±ì´ ë†’ë‹¤ëŠ” ë‹¨ì ì„ ê°–ëŠ”ë‹¤.</li>
  <li>ìµœê·¼ REALMê³¼ ORQA ê°™ì€ hybrid ëª¨ë¸ì€ ë¯¸ë¶„ ê°€ëŠ¥í•œ retrieverë¥¼ ì‚¬ìš©í•˜ì—¬ ì§€ì‹ì„ ìˆ˜ì •í•˜ê³  í™•ì¥í•¨ìœ¼ë¡œì„œ ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤. ì´ê²ƒìœ¼ë¡œ íŠ¹íˆ open-domain question answering (QA)ì—ì„œ ì¢‹ì€ ê²°ê³¼ë¥¼ ë³´ì˜€ë‹¤.</li>
</ul>

<p><br /></p>

<h1 id="method">Method</h1>

<p align="center">
    <img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-11-05-rag/fig1.png?raw=true" style="zoom: 100%;" />
</p>

<p>Retrieval-augmented generation (RAG)ì€ pre-trained generation ëª¨ë¸ì´ non-parametric memoryë¥¼ ì‚¬ìš©í•´ ë³´í¸ì ì¸ taskë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ fine-tuning í•œë‹¤.</p>
<ul>
  <li>Parametric memory: pre-trained seq2seq transformer</li>
  <li>Non-parametric memory: Wikipediaë¡œë¶€í„° pre-trained neural retrieverë¥¼ í†µí•´ ì–»ëŠ” dense vector index.</li>
  <li>Dense passage retriever (DPR): inputì„ ì¡°ê±´ìœ¼ë¡œ latent documentë¥¼ ê²€ìƒ‰í•˜ëŠ” retriever.</li>
  <li>BART: inputê³¼ latent documentë¥¼ ì¡°ê±´ìœ¼ë¡œ outputì„ ìƒì„±í•˜ëŠ” generator. T5 ë“± ë‹¤ë¥¸ seq2seq ëª¨ë¸ë¡œ ëŒ€ì²´ ê°€ëŠ¥í•˜ë‹¤. Retrieverì™€ í•¨ê»˜ fine-tuning ëœë‹¤.</li>
  <li>Latent document: top-K ê·¼ì‚¬ë¥¼ í†µí•´ output(ì‹œí€€ìŠ¤) ë³„ ë˜ëŠ” í† í° ë³„ë¡œ marginalizing ëœë‹¤.
    <ul>
      <li>RAG-Sequence Model: í•˜ë‚˜ì˜ ë¬¸ì„œê°€ ëª¨ë“  í† í°ì˜ ì¶œì²˜ê°€ ëœë‹¤ê³  ê°€ì •í•œë‹¤.</li>
      <li>RAG-Token Model: ì—¬ëŸ¬ ë¬¸ì„œê°€ í•œ í† í°ì„ ìƒì„±í•˜ëŠ” ë° ì¶œì²˜ê°€ ëœë‹¤ê³  ê°€ì •í•œë‹¤.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="models">Models</h2>

<p>RAG ëª¨ë¸ì€ input ì‹œí€€ìŠ¤ $x$ë¥¼ ì‚¬ìš©í•´ text document $z$ë¥¼ ê²€ìƒ‰í•˜ê³ , ì´ë¥¼ target ì‹œí€€ìŠ¤ $y$ë¥¼ ìƒì„±í•  ë•Œ ì¶”ê°€ì ì¸ ë¬¸ë§¥ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤. RAG ë‘ ê°€ì§€ êµ¬ì„± ìš”ì†Œë¡œ ì´ë£¨ì–´ì§„ë‹¤:</p>
<ul>
  <li>Retriever $p_\eta(z\mid x)$: ì¿¼ë¦¬ì¸ $x$ì— ëŒ€í•œ ë¬¸ì„œë“¤ì˜ ë¶„í¬ë¥¼ ë°˜í™˜í•œë‹¤.
    <ul>
      <li>Truncated as top-K assumtion.</li>
    </ul>
  </li>
  <li>Generator $p_\theta(y_i\mid x,z,y_{1:i-1})$: ì´ì „ í† í°ë“¤ $y_{1:i-1}$ê³¼ í˜„ì¬ input $x$ ë° ê²€ìƒ‰ëœ ë‚´ìš© $z$ì„ ê¸°ë°˜ìœ¼ë¡œ í˜„ì¬ ìŠ¤í…ì˜ í† í°ì„ ìƒì„±í•œë‹¤.
Retrieverì™€ GeneratorëŠ” ê²€ìƒ‰ëœ ë¬¸ì„œë¥¼ latent variableë¡œ ì·¨ê¸‰í•˜ì—¬ end-to-endë¡œ í•™ìŠµëœë‹¤. latent documentë¥¼ marginalize í•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œ RAG-Sequenceì™€ RAG-Token ë‘ ê°€ì§€ ë°©ë²•ì´ ì œì•ˆë˜ì—ˆë‹¤.</li>
</ul>

<p><br /></p>

<h2 id="rag-sequence-and-rag-token">RAG-Sequence and RAG-Token</h2>

<p><strong>RAG-Sequence Model</strong>: ê²€ìƒ‰ëœ ë™ì¼í•œ ë¬¸ì„œë¥¼ ì‚¬ìš©í•´ ì „ì²´ ì‹œí€€ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.</p>

<ul>
  <li>ê²€ìƒ‰ëœ ë¬¸ì„œëŠ” top-k seq2seq í™•ë¥  $p(y\mid x)$ì„ ì–»ê¸° ìœ„í•œ ë‹¨ì¼ latent variableë¡œ ê°„ì£¼ëœë‹¤.</li>
  <li>Retrieverë¡œ top-K ë¬¸ì„œë¥¼ ê²€ìƒ‰í•˜ê³ , Generatorë¡œ ê° ë¬¸ì„œì— ëŒ€í•´ output ì‹œí€€ìŠ¤ì— ëŒ€í•œ í™•ë¥ ì„ ê³„ì‚°í•œë‹¤.</li>
</ul>

\[p_{RAG-Sequence}(y\mid x)\approx \sum_{z\in top-k(p(\cdot|x))}{p_\eta(z|x)p_\theta(y_i|x,z)} \\ = \sum_{z\in top-k(p(\cdot|x))}{p_\eta(z|x)}\prod_i^N p_\theta(y_i|x,z,y_{1:i-1})\]

<ul>
  <li>Use cases: ìš”ì•½ê³¼ ê°™ì€ ë¬¸ì„œì˜ ì „ì²´ì ì¸ ë§¥ë½ì´ ì¤‘ìš”í•œ ì‘ì—…ì— ì í•©í•˜ë‹¤.</li>
</ul>

<p><strong>RAG-Token Model</strong>: ê° í† í°ì„ ìƒì„±í•  ë•Œ ë‹¤ë¥¸ latent documentë¥¼ ì‚¬ìš©í•œë‹¤.</p>
<ul>
  <li>GeneratorëŠ” ì—¬ëŸ¬ ë¬¸ì„œì—ì„œ ë‚´ìš©ì„ ì¶”ì¶œí•˜ì—¬ outputì„ ìƒì„±í•œë‹¤.</li>
  <li>RetrieverëŠ” top-K ë¬¸ì„œë¥¼ ê²€ìƒ‰í•˜ê³  GeneratorëŠ” ê° ë¬¸ì„œì— ëŒ€í•´ ë‹¤ìŒ output í† í°ì— ëŒ€í•œ ë¶„í¬ë¥¼ ê³„ì‚°í•œë‹¤.</li>
</ul>

\[p_{RAG-Token}(y|x)\approx \prod_i^N \sum_{z\in top-k(p(\cdot\mid x))}p_\eta(z\mid x)p_\theta(y_i\mid x,z_i,y_{1:i-1})\]

<ul>
  <li>Use cases: QAì™€ ê°™ì´ ì—¬ëŸ¬ ìë£Œë¥¼ ì¶œì²˜ë¡œ ìƒì„¸í•œ ì •ë³´ë¥¼ í†µí•©í•˜ëŠ” ì‘ì—…ì— ì í•©í•˜ë‹¤.</li>
</ul>

<p><br /></p>

<h2 id="retriever-and-generator">Retriever and Generator</h2>

<p><strong>Retriever</strong> $p_\mu(z\mid x)$: bi-encoder êµ¬ì¡°ë¥¼ ê°–ëŠ” DPRì„ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤:</p>

\[p_\mu(z|x)\propto \exp(\bf d \rm (z)^\top \bf q \rm (x)) \\
\bf d \rm (z)=\rm BERT_d(z), \ \bf q \rm (x)=\rm BERT_q(x)\]

<ul>
  <li>$\bf d \rm (z)$: ë¬¸ì„œì— ëŒ€í•œ representation. $\rm BERT_{BASE}$ ê¸°ë°˜ document encoderê°€ ìƒì„±í•œë‹¤.</li>
  <li>$\bf q \rm (x)$: ì¿¼ë¦¬ì— ëŒ€í•œ representation. $\rm BERT_{BASE}$ ê¸°ë°˜ query encoderê°€ ìƒì„±í•œë‹¤.</li>
  <li><span style="background-color:#fff5b1">Maximum inner product search (MIPS)</span>: top-k $p_\eta(\cdot\mid x)$ë¥¼ sub-linearì— ê·¼ì ‘í•œ ì‹œê°„ ë‚´ ê³„ì‚°í•˜ëŠ” ë°©ë²•</li>
  <li><span style="background-color:#fff5b1">Non-parametric memory</span>: ë¬¸ì„œì˜ ì¸ë±ìŠ¤. RetrieverëŠ” TriviaQAì˜ ì§ˆë¬¸ê³¼ Natural Questionsì— ëŒ€í•´ ë‹µí•˜ëŠ” ë° í•„ìš”í•œ ë¬¸ì„œë¥¼ ê²€ìƒ‰í•˜ë„ë¡ í•™ìŠµëœë‹¤.</li>
</ul>

<p><strong>Generator</strong> $p_\theta(y_i\mid x,z,y_{1:i-1})$: ì´ ì—°êµ¬ì—ì„œëŠ” BARTë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ë‚˜, ì–´ë–¤ encoder-decoder ëª¨ë¸ë¡œë„ ëŒ€ì²´ë  ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>$\rm BART_{large}$: 400M íŒŒë¼ë¯¸í„°ë¥¼ ê°–ëŠ” pre-trained seq2seq transformer. ë‹¤ì–‘í•œ noising functionê³¼ denoising objectiveë¡œ pre-training ë˜ì—ˆë‹¤.</li>
  <li>Input $x$ì™€ ê²€ìƒ‰ëœ ë¬¸ì„œ $z$ë¥¼ concatenate í•˜ì—¬ $\rm BART$ ëª¨ë¸ì— ì…ë ¥í•˜ê³  outputì„ ìƒì„±í•œë‹¤.</li>
  <li><span style="background-color:#fff5b1">Parametric memory</span>: $\rm BART$ generatorì˜ íŒŒë¼ë¯¸í„° $\theta$.</li>
</ul>

<p><br /></p>

<h2 id="training">Training</h2>

<p>Retrieverì™€ generatorëŠ” ì–´ë–¤ ë¬¸ì„œë¥¼ ê²€ìƒ‰í•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•œ ì •ë‹µ ì—†ì´ í•™ìŠµëœë‹¤.</p>
<ul>
  <li>Objective: input/output ìŒ $(x_j, y_j)$ì˜ negative marginal log-likelihood ìµœì†Œí™”, $\sum_j-\log(p(y_j\mid x_j))$.
    <ul>
      <li>Adam optimizer ì‚¬ìš©.</li>
    </ul>
  </li>
  <li>Query encoder $\rm BERT_q$ì™€ generator $\rm BART$ë§Œ finetune í•œë‹¤.
    <ul>
      <li>Document encoder $\rm BERT_d$ ì—…ë°ì´íŠ¸ëŠ” ë¹„ìš©ì´ ë§ì´ ë“¤ê³  ë¹„íš¨ìœ¨ì ì´ë‹¤.
        <ul>
          <li>Document indexë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•´ì•¼ í•œë‹¤.</li>
          <li>ì„±ëŠ¥ í–¥ìƒì— ê·¸ë‹¤ì§€ ìœ ì˜ë¯¸í•˜ì§€ ì•Šë‹¤.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="decoding">Decoding</h2>

<p>í…ŒìŠ¤íŠ¸ ì‹œ, RAG-Sequenceì™€ RAG-Tokenì€ $\arg \max_y{p(y\mid x)}$ë¥¼ ê·¼ì‚¬í•˜ê¸° ìœ„í•œ ì„œë¡œ ë‹¤ë¥¸ ë°©ë²•ì„ í•„ìš”ë¡œ í•œë‹¤.</p>

<p><strong>RAG-Sequence model</strong>: ê° ë¬¸ì„œ $z$ì— ëŒ€í•´ beam searchë¥¼ ì‚¬ìš©í•œë‹¤. $p(y\mid x)$ì€ ê¸°ì¡´ ë³´í¸ì ì¸ í† í°ë³„ í™•ë¥ ë¡œ ë¶„í•´í•  ìˆ˜ ì—†ì–´ ë‹¨ì¼ beam searchë¡œ êµ¬í•  ìˆ˜ ì—†ë‹¤.</p>
<ul>
  <li>ê° $z$ì˜ hypothesisëŠ” $p_\theta(y_i\mid x,z,y_{1:i-1})$ë¡œ ì ìˆ˜ê°€ ë§¤ê²¨ì§„ë‹¤.</li>
  <li>hypothesis ì§‘í•© $Y$ì— í¬í•¨ëœ ì¼ë¶€ $y$ëŠ” ëª¨ë“  ë¬¸ì„œì˜ beamì—ì„œ ë‚˜íƒ€ë‚˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.</li>
  <li><span style="background-color:#fff5b1">Thorough Decoding</span>: $y$ì˜ í™•ë¥ ì„ ì¶”ì •í•˜ê¸° ìœ„í•´, $y$ê°€ beamì— ë‚˜íƒ€ë‚˜ì§€ ì•ŠëŠ”  $z$ ê°ê°ì— ëŒ€í•´ ì¶”ê°€ì ìœ¼ë¡œ forward passë¥¼ ì§„í–‰í•˜ê³ , generatorì˜ í™•ë¥ ì„ $p_\eta(z\mid x)$ì™€ ê³±í•œ ë’¤, beamì˜ í™•ë¥ ì„ ë”í•œë‹¤.</li>
  <li><span style="background-color:#fff5b1">Fast Decoding</span>: í›„ë³´ ì§‘í•© $Y$ê°€ ìƒì„±ë˜ì—ˆì„ ë•Œ, forward passë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ $p_\theta(y\mid x,z_i) \approx 0$ë¡œ ê·¼ì‚¬í•´ íš¨ìœ¨ì ìœ¼ë¡œ decodingì„ ìˆ˜í–‰í•œë‹¤. ì´ ë°©ë²•ì€  $x, z_i$ì—ì„œ beam searchë¥¼ í–ˆì„ ë•Œ $y$ê°€ ìƒì„±ë˜ì§€ ì•Šì€ ê²½ìš° ìœ íš¨í•˜ë‹¤.</li>
  <li>ê¸´ output ì‹œí€€ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ê²½ìš°, $\left\vert Y \right\vert$ê°€ ì—¬ëŸ¬ forward passë¥¼ ìˆ˜í–‰í•˜ë©° ì»¤ì§ˆ ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>RAG-Token model</strong>: transition í™•ë¥ ì„ ê°–ëŠ” ê¸°ë³¸ì ì¸ autoregressive seq2seq generatorì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì‘ë™í•œë‹¤:</p>

\[p'_\theta(y_i\mid x,y_{1,i-1})=\sum_{z\in top-k(p(\cdot \mid x))}p_\eta(z_i \mid x)p_\theta(y_i\mid x,z_i,y_{1:i-1})\]

<p><br /></p>

<h1 id="experiments">Experiments</h1>

<p>RAG ëª¨ë¸ì´ knowledge-intensive NLP taskì—ì„œ íš¨ê³¼ì ì¸ì§€ì— ëŒ€í•œ ì„±ëŠ¥ì„ í‰ê°€í•˜ê¸° ìœ„í•´ ë‹¤ì–‘í•œ taskë¥¼ ì„¤ì •í–ˆë‹¤. ëª¨ë¸ ê´€ë ¨ setting ì‚¬í•­ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:</p>
<ul>
  <li>Wikipedia December 2018 dumpë¥¼ non-parametric knwoledge sourceë¡œ ì‚¬ìš©í–ˆë‹¤.</li>
  <li>Wikipedia ë¬¸ì„œë¥¼ 100 ë‹¨ì–´ì”© í•œ chunkë¡œ ë‚˜ëˆ„ì–´ ì´ 2,100ë§Œ ê°œ ë¬¸ì„œë¡œ êµ¬ì„±í–ˆë‹¤.</li>
  <li>Document encoder $\rm BERT_d$ë¡œ ê° ë¬¸ì„œì— ëŒ€í•œ ì„ë² ë”©ì„ êµ¬í•˜ê³ , ë¹ ë¥¸ ê²€ìƒ‰ì„ ìœ„í•´ Hierarchical Navigable Small World approximationì„ ì‚¬ìš©í•´ ë‹¨ì¼ MIPS ì¸ë±ìŠ¤ë¥¼ êµ¬ì¶•í–ˆë‹¤.</li>
  <li>ê° ì¿¼ë¦¬ì— ëŒ€í•´ top $k$ê°œì˜ ë¬¸ì„œë¥¼ ê²€ìƒ‰í•  ë•Œ, $k\in {5,10}$ë¡œ ì„¤ì •í•˜ì—¬ í•™ìŠµê³¼ í…ŒìŠ¤íŠ¸ ì‹œ ë°˜ì˜í–ˆë‹¤.</li>
</ul>

<h2 id="tasks">Tasks</h2>

<ol>
  <li><strong>Open-domain Question Answering (QA)</strong>: ì¤‘ìš”í•œ real-world applicationì´ì ë³´í¸ì ì¸ knowledge-intensive taskì´ë‹¤.
    <ul>
      <li>í…ìŠ¤íŠ¸ ìŒ $(x,y)$ëŠ” ì§ˆë¬¸ê³¼ ë‹µë³€ì— ë§¤ì¹­ëœë‹¤.</li>
      <li>RAGëŠ” ë‹µë³€ ìƒì„± ì‹œ negative log-likelihoodë¥¼ ìµœì†Œí™”í•˜ë„ë¡ í•™ìŠµëœë‹¤.</li>
      <li>Close-book QAë¥¼ í†µí•œ ë¹„êµë„ ì§„í–‰: ê²€ìƒ‰ ì—†ì´ ì˜¤ë¡œì§€ ëª¨ë¸ì— ë‚´ì œëœ parametric knowledgeë¡œ ì‹œí€€ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.</li>
      <li>Datasets: Natural Questions, TriviaQA, WebQuestions, CuratedTREC</li>
    </ul>
  </li>
  <li><strong>Abstractrive Question Answering</strong>: ììœ  í˜•ì‹ì´ë‚˜ ì¶”ìƒì ì¸ ê²½ìš°ì—ì„œì˜ natural language generation (NLG) ì„±ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•œë‹¤.
    <ul>
      <li>MSMARCO NLG Task v2.1 ì‚¬ìš©: ì›ë˜ ì¡´ì¬í•˜ëŠ” gold passageëŠ” ë°°ì œí•˜ê³ , ì§ˆë¬¸ê³¼ ë‹µë³€ë§Œ ì‚¬ìš©í•˜ì—¬ open-domain abstractive QA taskë¥¼ êµ¬ì„±í–ˆë‹¤.</li>
    </ul>
  </li>
  <li><strong>Jeopardy Question Generation</strong>: QA ìƒí™©ì´ ì•„ë‹Œ ê²½ìš°ì˜ ìƒì„± ëŠ¥ë ¥ì„ í‰ê°€í•œë‹¤.
    <ul>
      <li>Jeopardy: íŠ¹ì • entityì— ëŒ€í•œ ì‚¬ì‹¤ì„ ë³´ê³  entityë¥¼ ì¶”ì¸¡í•˜ëŠ” ê²ƒ.
        <ul>
          <li>ì˜ˆë¥¼ ë“¤ì–´, â€œ1986ë…„ ë©•ì‹œì½”ëŠ” ì´ êµ­ì œ ìŠ¤í¬ì¸  ëŒ€íšŒë¥¼ ë‘ ë²ˆ ê°œìµœí•œ ì²« ë²ˆì§¸ êµ­ê°€ë¡œ ê¸°ë¡ë˜ì—ˆë‹¤.â€ë¼ëŠ” ì‚¬ì‹¤ì„ ë³´ê³ , ì´ ì‚¬ì‹¤ì— í•´ë‹¹í•˜ëŠ” entityì¸ â€œì›”ë“œì»µâ€ì„ ì¶”ì¸¡í•´ì•¼ í•œë‹¤.</li>
        </ul>
      </li>
      <li>ì •í™•í•˜ê³  ì‚¬ì‹¤ì ì¸ ì„±ê²©ì´ ê°•í•œ taskë¡œ, ë‹µë³€ì¸ entityë¥¼ ì¡°ê±´ìœ¼ë¡œ í•˜ì—¬ ìƒì„±í•˜ëŠ” ë¶€ë¶„ì´ ê¹Œë‹¤ë¡œìš´ knowledge-intensive taskì´ë‹¤.</li>
    </ul>
  </li>
  <li><strong>Fact Verification</strong> (FEVER): ê³ ë‚œì´ë„ì˜ í•¨ì˜ ì¶”ë¡ ê³¼ ê²°í•©ëœ ê²€ìƒ‰ ë¬¸ì œì´ë‹¤.
    <ul>
      <li>í…ìŠ¤íŠ¸ê°€ Wikipediaì— ë”°ë¼ ë§ëŠ” ë‚´ìš©ì¸ì§€, í‹€ë ¸ëŠ”ì§€, ë˜ëŠ” íŒë‹¨í•  ì¶©ë¶„í•œ ì •ë³´ê°€ ì—†ëŠ”ì§€ë¥¼ ë¶„ë¥˜í•´ì•¼ í•œë‹¤.</li>
      <li>ëª¨ë¸ì˜ ìƒì„± ëŠ¥ë ¥ì´ ì•„ë‹Œ ë¶„ë¥˜ ëŠ¥ë ¥ì„ í…ŒìŠ¤íŠ¸í•˜ê¸°ì— ì ì ˆí•˜ë‹¤.</li>
      <li>Two varients: 3-way classification (supports/refutes/not enough)ê³¼ 2-way (support/refutes).</li>
    </ul>
  </li>
</ol>

<p><br /></p>

<h1 id="results">Results</h1>

<p>RAG ëª¨ë¸ì€ ì—¬ëŸ¬ taskì—ì„œ baseline ëª¨ë¸ ì´ìƒì˜ ì„±ëŠ¥ì„ ë³´ì˜€ë‹¤.</p>

<h2 id="open-domain-qa">Open-Domain QA</h2>

<p align="center">
    <img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-11-05-rag/table1_2.png?raw=true" style="zoom: 100%;" />
</p>

<ul>
  <li>RAG ëª¨ë¸ì€ baselineì„ í¬ê²Œ ëŠ¥ê°€í•˜ëŠ” ì ìˆ˜ë¥¼ ê¸°ë¡í–ˆë‹¤.</li>
  <li>íŠ¹íˆ RAG-Token ëª¨ë¸ì€ ì—¬ëŸ¬ ë¬¸ì„œì˜ ì„¸ì„¸í•œ ì •ë³´ë¥¼ í†µí•©í•˜ëŠ” ëŠ¥ë ¥ì— ì˜í•´ ìš°ìˆ˜í•œ ì„±ëŠ¥ì„ ë³´ì˜€ë‹¤.</li>
</ul>

<p><br /></p>

<h2 id="abstractive-question-answering">Abstractive Question Answering</h2>

<p align="center">
    <img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-11-05-rag/table3.png?raw=true" style="zoom: 100%;" />
</p>

<ul>
  <li>ë‹¤ìˆ˜ì˜ ì§ˆë¬¸ì´ gold passage ì—†ì´ ëŒ€ë‹µí•  ìˆ˜ ì—†ì—ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  RAG ëª¨ë¸ì´ SOTA ì„±ëŠ¥ì„ ë‹¬ì„±í–ˆë‹¤.</li>
  <li>RAG ëª¨ë¸ì€ BARTì— ë¹„í•´ hallucinationì„ ì ê²Œ ì¼ìœ¼ì¼°ê³  ì‚¬ì‹¤ì ìœ¼ë¡œ ì •í™•í•˜ë©´ì„œë„ ë‹¤ì–‘í•œ í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í–ˆë‹¤ (Table 3).</li>
</ul>

<p><br /></p>

<h2 id="jeopardy-question-generation">Jeopardy Question Generation</h2>

<p align="center">
    <img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-11-05-rag/table4_5.png?raw=true" style="zoom: 100%;" />
</p>
<p>
  <img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-11-05-rag/fig2.png?raw=true" style="zoom: 100%;" />
</p>

<ul>
  <li>ë‘ RAG model ëª¨ë‘ Q-BLEU-1ì—ì„œ BARTë¥¼ ëŠ¥ê°€í–ˆë‹¤ (Table 2).</li>
  <li>Human evaluatorëŠ” RAGê°€ ìƒì„±í•œ ê²°ê³¼ê°€ 42.7%ì˜ ê²½ìš°ì—ì„œ ë” ì‚¬ì‹¤ì ì´ë¼ê³  í‰ê°€í•´, SOTAì¸ generation ëª¨ë¸ë³´ë‹¤ ë” ë‚˜ì€ ìƒì„± ëŠ¥ë ¥ì„ ì…ì¦í–ˆë‹¤ (Table 4).</li>
  <li>RAG-Token ëª¨ë¸ì´ RAG-Sequence ëª¨ë¸ë³´ë‹¤ ì„±ëŠ¥ì´ ë” ì¢‹ê²Œ ë‚˜íƒ€ë‚¬ëŠ”ë°, ì—¬ëŸ¬ ë¬¸ì„œì˜ ë‚´ìš©ì„ íš¨ê³¼ì ìœ¼ë¡œ ê²°í•©í•˜ê¸° ë•Œë¬¸ì¸ ê²ƒìœ¼ë¡œ ìƒê°ëœë‹¤ (Fig 2).</li>
</ul>

<p><br /></p>

<h2 id="fact-verification">Fact Verification</h2>

<ul>
  <li>3-way classificationì—ì„œ RAGëŠ” íŠ¹ì • ë„ë©”ì¸ì— ëŒ€í•œ ì¤‘ê°„ ê²€ìƒ‰ì— ëŒ€í•´ ì§€ë„í•™ìŠµëœ SOTA ëª¨ë¸ ì ìˆ˜ì˜ 4.3% ë²”ìœ„ ë‚´ì˜ ì ìˆ˜ë¥¼ ê¸°ë¡í–ˆë‹¤.</li>
  <li>2-way classificationì—ì„œëŠ” gold evidenceë¥¼ ê¸°ë°˜ìœ¼ë¡œ true/false classificationì„ í•™ìŠµí•œ SotA ëª¨ë¸ê³¼ ë¹„êµí•´ 2.7% ì´ë‚´ì˜ ì„±ëŠ¥ì„ ë‹¬ì„±í–ˆë‹¤.</li>
  <li>RAGê°€ ê²€ìƒ‰í•œ ë¬¸ì„œëŠ” FEVERì˜ gold evidenceì™€ ìƒë‹¹ ë¶€ë¶„ ê²¹ì³¤ë‹¤.</li>
</ul>

<p><br /></p>

<h2 id="additional-results">Additional Results</h2>

<ol>
  <li>
    <p><strong>Generation Diversity</strong>: ì„œë¡œ ë‹¤ë¥¸ ëª¨ë¸ì´ ìƒì„±í•œ ngramì˜ ë¹„ìœ¨ì„ ê³„ì‚°í•˜ì—¬ outputì˜ ë‹¤ì–‘ì„±ì„ ì¡°ì‚¬í•œ ê²°ê³¼, RAG ëª¨ë¸ì´ BARTë³´ë‹¤ ë” ë‹¤ì–‘í•œ outputì„ ìƒì„±í–ˆë‹¤. RAG-Tokenë³´ë‹¤ëŠ” RAG-Sequenceì˜ outputì´ ë” ë‹¤ì–‘í–ˆë‹¤ (Table 5).</p>
  </li>
  <li>
    <p><strong>Retrieval Ablations</strong>: í•™ìŠµ ì¤‘ retrieverë¥¼ freezeí–ˆì„ ë•Œ ì›ë˜ ë°©ì‹ì˜ RAG ëª¨ë¸ì— ë¹„í•´ ì„±ëŠ¥ì´ í•˜ë½í–ˆë‹¤. Retrieverë¥¼ BM25ë¡œ ëŒ€ì²´í•˜ì—¬ ë¹„êµí–ˆì„ ë•Œë„ í•™ìŠµëœ retrieverì˜ ì„±ëŠ¥ì´ ë” ë†’ì€ ê²ƒì„ ë³¼ ìˆ˜ ìˆì—ˆë‹¤ (table 6).</p>

    <p align="center">
    <img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-11-05-rag/table6.png?raw=true" style="zoom: 100%;" />
</p>
  </li>
  <li>
    <p><strong>Index hot-swapping</strong>: December 2016 Wikipedia dumpì˜ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ non-parametric memoryì˜ ì´ì ì„ ì…ì¦í–ˆë‹¤. RAG ëª¨ë¸ì€ ì¸ë±ìŠ¤ê°€ ë°”ë€Œì—ˆìŒì—ë„ ì§ˆë¬¸ì˜ 70%ë¥¼ ë§ê²Œ ëŒ€ë‹µí–ˆë‹¤. ì´ë¡œì„œ non-parametric memoryë¥¼ ë‹¨ìˆœíˆ êµì²´í•˜ì—¬ knowledgeë¥¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>
  </li>
  <li>
    <p><strong>Effect of Retrieving more documents</strong>: í…ŒìŠ¤íŠ¸ ì‹œ ê²€ìƒ‰ë  ë¬¸ì„œì˜ ìˆ˜ $k$ë¥¼ ì¡°ì •í•œ ê²°ê³¼, taskì— ë”°ë¼ì„œ íŠ¹ì • ê°œìˆ˜ê¹Œì§€ì˜, í˜¹ì€ ë§ì€ ë¬¸ì„œë¥¼ ê²€ìƒ‰í• ìˆ˜ë¡ ì„±ëŠ¥ì´ í–¥ìƒë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤ (fig 3).</p>

    <p align="center">
    <img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-11-05-rag/fig3.png?raw=true" style="zoom: 100%;" />
</p>
  </li>
</ol>

<p><br /></p>

    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$$', '$$$'], ['\\[', '\\]'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
</script>
<script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://alatteaday.github.io/ko/papers/2023/09/15/STraTS/">
        [Paper] Self-Supervised Transformer for Sparse and Irregularly Sampled Multivariate Clinical Time-Series (ACM 2022)
      </a>
    </h1>
    <!--<span class="post-date">15 Sep 2023</span>-->
    <p class="post-date">15 Sep 2023&nbsp;&nbsp;&nbsp;&nbsp;
      
        
          
            <span class="tag" data-tag="bio">
              <a href="https://alatteaday.github.io/ko/tags/?tag=bio">
                #bio
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="ehr">
              <a href="https://alatteaday.github.io/ko/tags/?tag=ehr">
                #ehr
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="transformer">
              <a href="https://alatteaday.github.io/ko/tags/?tag=transformer">
                #transformer
              </a>
            </span>
            
        
      
    </p>
    <!--
    
    -->
    <p>Tipirneni, Sindhu, and Chandan K. Reddy. â€œSelf-supervised transformer for sparse and irregularly sampled multivariate clinical time-series.â€ <em>ACM Transactions on Knowledge Discovery from Data (TKDD)</em> 16.6 (2022): 1-17.</p>

<p><a href="https://dl.acm.org/doi/full/10.1145/3516367">Paper Link</a></p>

<h2 id="points">Points</h2>

<p><strong>Self-supervised Transformer for Time-Series (STraTS) model</strong></p>

<ul>
  <li>
    <p>Using observation triplets as time-series components: avoids the problems faced by aggregation and imputation methods for sparse and sporadic multivariate time-series</p>
  </li>
  <li>
    <p>Continuous Value Embedding: encodes continuous time and variable values without the need for discretization</p>
  </li>
  <li>
    <p>Transformer-based model: learns contextual triplet embeddings</p>
  </li>
  <li>
    <p>Time series forecasting as a proxy task: leverages unlabeled data to learn better generalized representations</p>
  </li>
</ul>

<h2 id="background">Background</h2>

<p>Problems</p>

<ul>
  <li>Multivariate time-series data are frequently observed in critical care settings and are typically characterized by sparsity (missing information) and irregular time intervals.</li>
  <li>Existing approaches, such as aggregation or imputation of values, suppress the fine-grained information and add undesirable noise/overhead into the model.</li>
  <li>The problem of limited availability of labeled data is easily observed in healthcare applications.</li>
</ul>

<p>The clinical domain portrays a unique set of challenges:</p>

<ul>
  <li>Missingness and Sparsity: Not all the variables are observed for every patient. Also, the time-series matrices are very sparse.</li>
  <li>Irregular time intervals and Sporadicity: Not all clinical variables are measured at regular time intervals. The measurements may occur sporadically in time depending.</li>
  <li>Limited labeled data: expensive and even more limited for specific tasks.</li>
</ul>

<p>Existing methods</p>

<ul>
  <li>Aggregation: could suppress important fine-grained information</li>
  <li>Imputation/Interpolation: not reasonable as not considering the domain knowledge about each variable</li>
</ul>

<h2 id="method">Method</h2>

<p><strong>Self-supervised Transformer for Time-Series (STraTS)</strong></p>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/1_fig3.png?raw=true" alt="" /></p>

<h3 id="embeddings">Embeddings</h3>

<p><strong>Triplet Emgeddings</strong> = Feature embedding + Value embedding + Time embedding
\(T=\{(t_i, j_i, u_i)\}^n_{i=1}\\
e_i=e_i^f+e_i^v+e_i^t\)
<strong>Continuous Value Embedding (CVE)</strong></p>

<p>For continuous values of feature values and times</p>

<p>A one-to-many Feed-Forward Network
\(FFN(x) = U tanh(Wx+b)\)</p>

<ul>
  <li>
    <p>Feature embeddings $e_i^f$: obtained from a simpole lookup table</p>
  </li>
  <li>
    <p>Value embeddings $e_i^v$ and Time embeddings$e_i^t$: through CVE</p>
  </li>
</ul>

<p><strong>Demographics Embedding</strong></p>

<p>the prediction models performed better when demographics were processed separately.
\(e^ğ‘‘ = ğ‘¡ğ‘ğ‘›â„(W^ğ‘‘_2ğ‘¡ğ‘ğ‘›â„(W^ğ‘‘_1d + b^ğ‘‘_1) + b^ğ‘‘_2) âˆˆ R^d\)
where the hidden layer has a dimension of 2d</p>

<h3 id="self-supervision">Self-Supervision</h3>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/2_fig2.png?raw=true" alt="" /></p>

<p>Pre-training Tasks: Both masking and forecasting as pretext tasks for providing self-supervision</p>

<p>The forecasitng improved the results on target tasks</p>

<p>The loss is:
\(L_{ss}=\frac{1}{|N'|}\sum_{k=1}^{N'}\sum_{j=1}^{|F|}m_j^k\Big(\tilde{z}_j^k-z_j^k\Big)^2\)</p>

<h3 id="interpretability">Interpretability</h3>

<p>I-STraTS: an interpretable version of STraTS</p>

<ul>
  <li>The output can be expressed using a linear combination of components that are derived from individual features</li>
</ul>

<p>Differences with STraTS</p>

<ul>
  <li>Combine the initial triplet embeddings in Fusion Self-attention module</li>
  <li>Directly use the raw demographics vector as the demographics embedding</li>
</ul>

\[\tilde{y}=sigmoid\Big(\sum_{j=1}^{D}{\bold{w}_0[j]d[j]+\sum_{i=1}^{n}\sum_{j=1}^{d}\alpha_i\bold{w}_o[j+D]\bold{e}_i[j]+b_o}\Big)\]

<h2 id="experiments">Experiments</h2>

<p>Target Task: Prediction of in-hospital mortality</p>

<p>Datasets: 2 EHR datasets; MIMIC-III and PhysioNet Challenge 2012</p>

<ul>
  <li>MIMIC-III: 46,000 patients</li>
  <li>PhysioNet-2012: 11,988 patients</li>
</ul>

<p>Baselines: Gated Recurrent Unit (GRU), Temporal Convolutional Network (TCN), Simply Attend and DIagnose (SaND), GRU with trainable Decays (GRU-D), Interpolation-prediction Network (InterpNet), Set Functions for Time Series (SeFT)</p>

<ul>
  <li>Used 2 dense layers for demographics encoding</li>
  <li>Concatenated it to the time-series representation before the last dense layer</li>
</ul>

<p>Metrics</p>

<ul>
  <li>ROC-AUC: Area under ROC curve</li>
  <li>PR-AUC: Area under precision-recall curve</li>
  <li>min(Re, Pr): the max of â€˜min of recall and precisionâ€™ across all thresholds</li>
</ul>

<h3 id="prediction-performance">Prediction Performance</h3>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/3_table4.png?raw=true" style="zoom:80%;" /></p>

<ul>
  <li>Trained each model using 10 different random samplings of 50% labeled data from the train and validation sets</li>
  <li>STraTS uses the entire labeled data and additional unlabeled data if avaliable</li>
  <li>STraTS achieves the best performance</li>
  <li>GRU showed better performance than interpolation-based models (GRU-D, InterpNet) on the MIMIC-III dataset, which was not expected</li>
</ul>

<p><strong>Generalizability test of models</strong></p>

<p>Lower propotions of labeled data can be observed in real-world when there are several right-censord samples.</p>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/4_fig5.png?raw=true" alt="" /></p>

<ul>
  <li>STraTS has an advantage compared to others in scarce labeled data settings, which can be attributed to self-supervision</li>
</ul>

<h3 id="ablation-study">Ablation Study</h3>

<p>Compared STraTS and I-STraTS with and without self-supervision: â€˜ss+â€™ and â€˜ss-â€˜ indicate each case</p>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/5_table5.png?raw=true" style="zoom:80%;" /></p>

<ul>
  <li>I-STraTS showed slightly worse performance as constrained its representations</li>
  <li>Adding self-supervision improves performance of both models</li>
  <li>I-STraTS(ss+) outperforms STraTS(ss-): self-supervision can compensate the performance which could get lower by introducing interpretability</li>
</ul>

<h3 id="interpretability-1">Interpretability</h3>

<p>How I-STraTS explains its predictions</p>

<p>A case study: a 85 yrs old female patient from MIMIC-III</p>

<ul>
  <li>expired on the 6th day after ICU admission</li>
  <li>had 380 measurements corresponding to 58 time-series variables</li>
</ul>

<p>The model predicts the probability of her in-hospital mortality as 0.94 using only the data collected the first day</p>

<p><img src="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-09-15-strats/6_table6.png?raw=true" alt="" /></p>

<ul>
  <li>Average contribution score: the average score along with the range, for multiple observations, or value, for only one observation</li>
  <li>The top 5 variables are the most important factors in predicting she â€˜s at high risk of mortality that the model observed</li>
</ul>

<p>&amp;rarr Can be helpful to identify high-risk patients and also understand the contributing factors and make better diagnoses, especially at the early stages of treatment</p>

    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$$', '$$$'], ['\\[', '\\]'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
</script>
<script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://alatteaday.github.io/ko/study/2023/08/29/demensiapapers/">
        [Study] ì•Œì¸ í•˜ì´ë¨¸ ì¹˜ë§¤ì˜ ATN ë°”ì´ì˜¤ë§ˆì»¤ ê°„ ê´€ê³„ ì •ë¦¬
      </a>
    </h1>
    <!--<span class="post-date">29 Aug 2023</span>-->
    <p class="post-date">29 Aug 2023&nbsp;&nbsp;&nbsp;&nbsp;
      
        
          
            <span class="tag" data-tag="bio">
              <a href="https://alatteaday.github.io/ko/tags/?tag=bio">
                #bio
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="brainImaging">
              <a href="https://alatteaday.github.io/ko/tags/?tag=brainImaging">
                #brainImaging
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="demensia">
              <a href="https://alatteaday.github.io/ko/tags/?tag=demensia">
                #demensia
              </a>
            </span>
            
        
          
            <span class="tag" data-tag="atn">
              <a href="https://alatteaday.github.io/ko/tags/?tag=atn">
                #atn
              </a>
            </span>
            
        
      
    </p>
    <!--
    
      Docker image ë° containerì™€ ê´€ë ¨í•˜ì—¬ ìì£¼ ì‚¬ìš©ë˜ëŠ” ëª…ë ¹ì–´ë¥¼ ì •ë¦¬í•´ë´…ë‹ˆë‹¤.
    
    -->
    <h2 id="ai-ì „ê³µìì˜-ì•Œì¸ í•˜ì´ë¨¸-ì¹˜ë§¤-ê´€ë ¨-brain-imaging-ë…¼ë¬¸-ìŠ¤í„°ë””">AI ì „ê³µìì˜ ì•Œì¸ í•˜ì´ë¨¸ ì¹˜ë§¤ ê´€ë ¨ Brain Imaging ë…¼ë¬¸ ìŠ¤í„°ë””</h2>

<p>Amyloid Beta(A), Tau(T), Neurodegeneration(N)ê³¼ ê´€ë ¨ëœ Alzheimerâ€™s Disease(AD) ê¸°ì „ì— ëŒ€í•´ ì´í•´í•˜ê¸° ìœ„í•˜ì—¬ ë‹¤ìŒì˜ ë…¼ë¬¸ë“¤ì„ ì½ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤. ê¸°ë°˜ ì§€ì‹ì´ ì—†ì–´ ì‹œê° ìë£Œì™€ ì‚¬ì „ì„ ì°¾ì•„ê°€ë©° ì½ì—ˆìŠµë‹ˆë‹¤. pdfëŠ” ì°¾ì•„ë³¸ ì´ë¯¸ì§€ì™€ í•„ê¸°í•œ ë‚´ìš©ì´ ë‹´ê¸´ ë…¼ë¬¸ íŒŒì¼ì…ë‹ˆë‹¤.</p>

<p>Ittner, Lars M., and JÃ¼rgen GÃ¶tz. â€œAmyloid-Î² and tauâ€”a toxic pas de deux in Alzheimerâ€™s disease.â€ <em>Nature Reviews Neuroscience</em> 12.2 (2011): 67-72. <a href="https://www.nature.com/articles/nrn2967">link</a> <a href="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-08-29-demensiapapers/nrn2967.pdf">pdf</a></p>

<p>Vogel, Jacob W., et al. â€œFour distinct trajectories of tau deposition identified in Alzheimerâ€™s disease.â€ <em>Nature medicine</em> 27.5 (2021): 871-881. <a href="https://www.nature.com/articles/s41591-021-01309-6">link</a> <a href="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-08-29-demensiapapers/s41591-021-01309-6.pdf">pdf</a></p>

<p>Lee, Wha Jin, et al. â€œRegional AÎ²-tau interactions promote onset and acceleration of Alzheimerâ€™s disease tau spreading.â€ <em>Neuron</em>110.12 (2022): 1932-1943. <a href="https://pubmed.ncbi.nlm.nih.gov/35443153/">link</a> <a href="https://github.com/alatteaday/alatteaday.github.io/blob/gh-pages/post_images/2023-08-29-demensiapapers/regional_onset.pdf">pdf</a></p>

<hr />

<p>Amyloid Beta(A)ëŠ” ë‰´ëŸ°ì— ì˜í•´ ìƒì„±ë˜ëŠ” Amyloid Precursor Protein(APP)ì´ í”„ë¡œí…Œì•„ì œì— ì˜í•´ 4ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ ì§ˆ ë•Œ ìƒê¸°ëŠ” í©íƒ€ì´ë“œ ì¤‘ í•˜ë‚˜ë¡œ,</p>

<p>ë‰´ëŸ° ê·¼ì²˜ì— ì¡´ì¬í•˜ì—¬ ê¸°ëŠ¥ ì¥ì• ë¥¼ ì•¼ê¸°í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•Œë ¤ì¡Œë‹¤. Aì˜ ì¹¨ì°©ì€ Alzheimerâ€™s Disease(AD) ë°œë³‘ 10-20ë…„ ì „ë¶€í„° ì´ë¤„ì§„ë‹¤.</p>

<ul>
  <li>
    <p>AëŠ” dimers, oligomers, fibrils ë“±ì— ì´ì–´ plaqueë¥¼ í˜•ì„±í•œë‹¤. Aê°€ ì–´ëŠ í˜•íƒœì—ì„œ toxicityë¥¼ ê°–ê¸° ì‹œì‘í•˜ëŠ”ì§€ëŠ” í™•ì‹¤í•˜ì§€ ì•Šë‹¤. í•­ ì•„ë°€ë¡œì´ë“œ ì¹˜ë§¤ ì¹˜ë£Œì œëŠ” ì´ plaqueì˜ ê°ì†Œì™€ ì¦ì‹ ë° ìƒì„± ë°©ì§€ë¥¼ ëª©ì ìœ¼ë¡œ í•œë‹¤.</p>
  </li>
  <li>
    <p>Aì˜ toxicityëŠ” postsynaptic compartment, ì¦‰ dendrite(somatodendritic region)ë¥¼ ì£¼ ëŒ€ìƒìœ¼ë¡œ í•˜ì—¬ ì‘ìš©í•˜ê³ , íŠ¹ì • ìˆ˜ìš©ì²´ì˜ ì†ì„±ì— ë”°ë¼ ì„¸í¬ë§‰ì„ í†µí•´ ê°„ì ‘ì ìœ¼ë¡œ ë‰´ëŸ°ì— ì˜í–¥ì„ ë¼ì¹  ìˆ˜ ìˆë‹¤. ëŒ€í‘œì ì¸ íŠ¹ì • ìˆ˜ìš©ì²´ë¡œ NMDARì´ ìˆë‹¤.</p>
  </li>
</ul>

<p>Tau(T)ëŠ” ì‹ ê²½ ì„¸í¬ì—ì„œ microtubuleê³¼ ê²°í•©í•˜ëŠ” ë‹¨ë°±ì§ˆë¡œ, ì£¼ë¡œ axonì— ì¡´ì¬í•˜ì—¬ microtubuleì˜ ì•ˆì •í™” ë° axonal transitionì„ ì¡°ì ˆí•˜ëŠ” ì—­í• ì„ í•œë‹¤.</p>

<p>ì •ìƒ ìƒíƒœì˜ ë‰´ëŸ°ì˜ dendriteì—ë„ ì†ŒëŸ‰ ì¡´ì¬í•œë‹¤.</p>

<p>TëŠ” Aì— ì˜í•´ ê³¼ì¸ì‚°í™”ë˜ê³ (hyperphosphorylated Tau), ê³¼ì¸ì‚°í™”ëœ TëŠ” Neurofibrillary Tangle(NFT)ë¥¼ í˜•ì„±í•œë‹¤.</p>

<ul>
  <li>Tì˜ ê³¼ì¸ì‚°í™”ëŠ” microtubule í˜•ì„±ì„ ë°©í•´í•˜ì—¬ ë‰´ëŸ°ì˜ ê¸°ëŠ¥ì„ ë°©í•´í•œë‹¤.</li>
  <li>NFTëŠ” Somatodendritic regionì—ì„œ ë§ì´ ê´€ì°°ëœë‹¤. Tì˜ levelì´ ë†’ì•„ì§€ë©´ Tê°€ dendriteì—ì„œ ë§ì´ ê´€ì°°ëœë‹¤.</li>
</ul>

<p>Dendriteì—ì„œ TëŠ” ê·¸ê³³ì— ìœ„ì¹˜í•œ ì—¬ëŸ¬ ë‹¨ë°±ì§ˆê³¼ ìƒí˜¸ì‘ìš©í•˜ì—¬ ê²°ê³¼ì ìœ¼ë¡œ ë‰´ëŸ°ì´ Aì˜ toxicityì— ì•½í•´ì§€ê²Œ ë§Œë“ ë‹¤.</p>

<ul>
  <li>Tê°€ ì¸ì‚°í™”ë˜ë©´ Tyrosine protein kinasen FYNê³¼ ê°•í•˜ê²Œ ì‘ìš©í•œë‹¤. ê³¼ì¸ì‚°í™”ëœ Tê°€ dendriteì—ì„œ ì¦ê°€í•¨ì— ë”°ë¼ FYNë„ Somaì—ì„œ ì¦ê°€í•œë‹¤.</li>
  <li>FYNì€ NMDARì„ ì¸ì‚°í™”í•œë‹¤. ì¸ì‚°í™”ëœ NMDARì€ Postsynaptic Density Protein 95(PDS95)ì™€ ìƒí˜¸ì‘ìš©í•œë‹¤.</li>
  <li>ì´ê²ƒì˜ ê²°ê³¼ë¡œ NMDARì˜ excitotoxicityê°€ ë‚˜íƒ€ë‚œë‹¤(í¥ë¶„ë…ì„±ìƒíƒœ). ìˆ˜ìš©ì²´ì˜ excitotoxicityë¡œ Aì˜ toxicityì— ë‰´ëŸ°ì´ ë¯¼ê°í•´ì§€ê²Œ ëœë‹¤.</li>
</ul>

<p>ê²°ê³¼ì ìœ¼ë¡œ Aì™€ TëŠ” ë‰´ëŸ°ì„ ì•½í™”ì‹œí‚¤ëŠ” ë°ì— ìˆì–´ ì„œë¡œ ì‹œë„ˆì§€ë¥¼ ê°–ëŠ”ë‹¤. AëŠ” Tì˜ ê³¼ì¸ì‚°í™”ë¥¼ ì´‰ì§„í•˜ê³ , ê³¼ì¸ì‚°í™”ëœ TëŠ” ë‰´ëŸ°ì´ Aì˜ toxicityì— ì•½í•´ì§€ê²Œ ë§Œë“ ë‹¤.</p>

<p>ì´ ì‹œìŠ¤í…œì—ì„œ Aì™€ TëŠ” ì„¸í¬ì˜ ë‹¤ë¥¸ ë¶€ë¶„(ê°ê° Complex I, Complex IV)ì— ì•…ì˜í–¥ì„ ë¼ì³ ë¯¸í† ì½˜ë“œë¦¬ì•„ í˜¸í¡ì„ ë°©í•´í•˜ê³ , ê²°êµ­ Neurodegeneration(N)ì„ ì•¼ê¸°í•œë‹¤.</p>

<p>ë”°ë¼ì„œ Aì˜ ì¹¨ì°©ê³¼ Tì˜ ì „íŒŒëŠ” ADì˜ ì¤‘ìš”í•œ ìš”ì¸ì´ë‹¤.</p>

<p>Tì˜ ì „íŒŒ ì–‘ìƒì€ Braak Staging Systemìœ¼ë¡œ ì²´ê³„í™”ëœ ë°” ìˆë‹¤.</p>

<ul>
  <li>Transentorhinal cortex â†’ medial and basal temporal lobe â†’ neocortical associative regions â†’ unimodal sensory and motor cortex</li>
</ul>

<p>ê·¸ëŸ°ë° ì´ systemì— ë¶€í•©í•˜ì§€ ì•ŠëŠ” ì „íŒŒ ì–‘ìƒ ë˜í•œ ê´€ì°°ë˜ì—ˆë‹¤. Tì˜ ì „íŒŒ ì–‘ìƒì„ ë³‘ì˜ ì§„í–‰ê³¼ ë‡Œ ì˜ì—­ì˜ ì‹œê³µê°„ì  ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¥˜í•˜ì—¬ 4ê°€ì§€ subtypeìœ¼ë¡œ ì •ì˜í•  ìˆ˜ ìˆë‹¤.</p>

<ul>
  <li>S1 limbic (Braak system), S2 MTL, S3 posterior, S4 Lateral Temporal</li>
</ul>

<p>ì¹¨ì°©ëœ AëŠ” Tì˜ ì „íŒŒì— ì˜í–¥ì„ ì¤€ë‹¤.</p>

<ul>
  <li>AëŠ” heteromodal association cortexì— ì¹¨ì°©ë˜ê³ , Tì˜ ì „íŒŒëŠ” entorhinal cortex(EC)ì—ì„œ ì‹œì‘ë˜ì–´ ì ì°¨ ë‡Œ ì „ë°˜ìœ¼ë¡œ í¼ì§„ë‹¤. ( â† Braak system; S1 type ? )</li>
  <li>Remote Interation: Aì™€ Tê°€ ê°™ì€ ì˜ì—­ì— ìˆì§€ ì•Šì€ ìƒíƒœì—ì„œ, ë¨¼ì € Aê°€ ì—°ê²°ëœ ë‰´ëŸ°ì„ í†µí•´ì„œ EC ì˜ì—­ì— ìˆëŠ” Tì— ì˜í–¥ì„ ì¤€ë‹¤. Aì˜ ì˜í–¥ìœ¼ë¡œ TëŠ” ì ì°¨ ì£¼ìœ„ ì˜ì—­ìœ¼ë¡œ í™•ì‚°ëœë‹¤.</li>
  <li>Local Interaction: Tê°€ Aì™€ ì§ì ‘ì ìœ¼ë¡œ ì ‘ì´‰ë˜ì–´ ìˆëŠ” ë‰´ëŸ°ì— ì „íŒŒë˜ì–´ ë§Œë‚¨ìœ¼ë¡œì„œ Tì˜ ì „íŒŒê°€ ê°€ì†í™”ëœë‹¤(acceleration). í•´ë‹¹ ë‡Œ ì˜ì—­ì€ Internal Temporal Gyrus(ITG)ì´ë‹¤ (propagation hub).</li>
  <li>T ì „íŒŒì˜ accelerationì´ ì§„í–‰ë˜ë©´ ë‡Œ ì „ë°˜ì—ì„œ Aì™€ Tì˜ ìƒí˜¸ì‘ìš©ì´ ì¼ì–´ë‚˜ê²Œ ë˜ì–´ Nê³¼ ADì˜ ì•…í™”ë¥¼ ë§‰ê¸° ì–´ë µë‹¤.</li>
</ul>

<p>Aì™€ Tì˜ PET ë°ì´í„°ì™€ MRI ë°ì´í„°ë¥¼ ë³‘ì˜ ì§„í–‰ì— ë”°ë¼ ì‚´í´ë³´ë©´</p>

<ul>
  <li>Aì˜ ì¹¨ì°©ë˜ëŠ” ì •ë„ëŠ” ë‡Œ ì „ë°˜ì— ê±¸ì³ ì ì  ì‹¬í•´ì§ˆ ê²ƒì´ê³ </li>
  <li>TëŠ” ë‡Œì˜ íŠ¹ì • ë¶€ë¶„ì—ì„œ ì‹œì‘í•˜ì—¬ ì ì°¨ í™•ì‚°ë˜ëŠ” ì–‘ìƒìœ¼ë¡œ ê´€ì°°ë˜ê³ </li>
  <li>Tì˜ ìŠˆí¼ ì „íŒŒê°€ ê´€ì°°ëœ ì´í›„ MRI ìƒ ì „ë°˜ì ì¸ ë‡Œ ìœ„ì¶•(N)ì˜ ì •ë„ê°€ ì‹¬í•˜ê²Œ ë‚˜íƒ€ë‚  ê²ƒì´ë‹¤.</li>
</ul>


    
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="https://alatteaday.github.io/ko/page5">Older</a>
  
  
    
      <a class="pagination-item newer" href="https://alatteaday.github.io/ko/page3">Newer</a>
    
  
</div>

        
      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='/public/js/script.js'></script>
  </body>
</html>
